<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>PlayVortex ¬∑ –ò–≥—Ä–æ–≤–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
        }

        body {
            background: #0a0c14;
            color: #fff;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* ===== –ê–ù–ò–ú–ê–¶–ò–ò ===== */
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
            100% { transform: translateY(0px); }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.03); }
            100% { transform: scale(1); }
        }

        @keyframes glow {
            0% { box-shadow: 0 0 5px #ffb347; }
            50% { box-shadow: 0 0 15px #ffb347, 0 0 20px #ff7f50; }
            100% { box-shadow: 0 0 5px #ffb347; }
        }

        @keyframes slideInUp {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .float { animation: float 3s ease-in-out infinite; }
        .pulse { animation: pulse 2s ease-in-out infinite; }
        .glow { animation: glow 3s ease-in-out infinite; }

        /* ===== –®–ê–ü–ö–ê ===== */
        .header {
            background: #151e2c;
            border-bottom: 3px solid #ffb347;
            padding: 12px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
            flex-wrap: wrap;
            gap: 10px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
        }

        .logo i {
            font-size: 2rem;
            color: #ffb347;
        }

        .logo h1 {
            font-size: 1.5rem;
            background: linear-gradient(135deg, #ffb347, #ff7f50);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .nav {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .nav a {
            color: #fff;
            text-decoration: none;
            cursor: pointer;
            padding: 5px 10px;
            font-size: 0.95rem;
            transition: 0.2s;
        }

        .nav a:hover,
        .nav a.active {
            color: #ffb347;
            border-bottom: 2px solid #ffb347;
        }

        .auth-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 6px 15px;
            border-radius: 50px;
            border: 2px solid #ffb347;
            background: transparent;
            color: white;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9rem;
            transition: 0.2s;
            white-space: nowrap;
        }

        .btn:hover {
            background: #ffb347;
            color: #0a0c14;
            transform: translateY(-2px);
        }

        .btn-primary {
            background: #ffb347;
            color: #0a0c14;
        }

        .btn-danger {
            background: #dc3545;
            border-color: #dc3545;
        }

        .btn-success {
            background: #28a745;
            border-color: #28a745;
        }

        .btn-small {
            padding: 4px 10px;
            font-size: 0.8rem;
        }

        /* ===== –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ù–¢ ===== */
        .main-content {
            flex: 1;
            max-width: 1200px;
            margin: 0 auto;
            padding: 15px;
            width: 100%;
        }

        /* ===== –ü–ê–ù–ï–õ–ò ===== */
        .panel {
            background: #151e2c;
            border-radius: 20px;
            padding: 20px;
            border: 2px solid #ffb347;
            margin-bottom: 20px;
            animation: slideInUp 0.5s ease;
        }

        .panel-title {
            color: #ffb347;
            font-size: 1.5rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            border-bottom: 2px solid #ffb347;
            padding-bottom: 8px;
        }

        /* ===== –ê–î–ê–ü–¢–ò–í–ù–´–ï –°–ï–¢–ö–ò ===== */
        .home-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
        }

        @media (min-width: 768px) {
            .home-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        .catalog-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
        }

        .games-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
        }

        @media (min-width: 768px) {
            .games-container {
                grid-template-columns: 1fr 1fr;
            }
        }

        /* ===== –ù–û–í–û–°–¢–ò ===== */
        .news-item {
            background: #1f2a3a;
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 5px solid #ffb347;
            cursor: pointer;
            transition: 0.2s;
        }

        .news-item:hover {
            transform: translateX(5px);
            background: #253040;
        }

        .news-date {
            color: #ffb347;
            font-size: 0.8rem;
            margin-bottom: 5px;
        }

        .news-title {
            font-size: 1.1rem;
            margin-bottom: 5px;
        }

        .news-preview {
            color: #a0a8c0;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        /* ===== –ö–ê–†–¢–û–ß–ö–ò –ò–ì–† ===== */
        .game-card {
            background: #1f2a3a;
            border-radius: 15px;
            padding: 15px;
            cursor: pointer;
            transition: 0.2s;
            text-align: center;
        }

        .game-card:hover {
            transform: translateY(-5px);
            border: 2px solid #ffb347;
        }

        .game-icon {
            font-size: 2rem;
            color: #ffb347;
            margin-bottom: 10px;
        }

        .game-card h4 {
            font-size: 1rem;
            margin-bottom: 5px;
        }

        .game-stats {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 8px;
            font-size: 0.8rem;
            color: #a0a8c0;
        }

        /* ===== –ó–ú–ï–ô–ö–ê ===== */
        .snake-game {
            text-align: center;
        }

        #snakeCanvas {
            width: 100%;
            max-width: 400px;
            height: auto;
            aspect-ratio: 1/1;
            border: 2px solid #ffb347;
            border-radius: 10px;
            background: #0a0c14;
            margin: 0 auto;
            display: block;
        }

        .score {
            color: #ffb347;
            font-size: 1.3rem;
            margin: 10px 0;
        }

        /* ===== –ö–õ–ò–ö–ï–† ===== */
        .clicker-game {
            text-align: center;
            padding: 15px;
        }

        .clicker-count {
            font-size: 3rem;
            color: #ffb347;
            margin-bottom: 15px;
        }

        .clicker-button {
            width: min(200px, 80%);
            height: min(200px, 80%);
            max-width: 200px;
            max-height: 200px;
            margin: 0 auto;
            aspect-ratio: 1/1;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, #ffb347, #ff7f50);
            border: 4px solid #fff;
            cursor: pointer;
            box-shadow: 0 0 20px rgba(255, 180, 70, 0.5);
        }

        .clicker-button:active {
            transform: scale(0.95);
        }

        .game-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        /* ===== –ü–†–û–§–ò–õ–¨ ===== */
        .profile-sidebar {
            position: fixed;
            right: 20px;
            top: 100px;
            width: 250px;
            z-index: 90;
        }

        @media (max-width: 768px) {
            .profile-sidebar {
                position: static;
                width: 100%;
                margin-top: 20px;
            }
        }

        .profile-card {
            background: #1f2a3a;
            border-radius: 20px;
            padding: 20px;
            border: 2px solid #ffb347;
            text-align: center;
        }

        .profile-avatar {
            width: 70px;
            height: 70px;
            background: #ffb347;
            border-radius: 50%;
            margin: 0 auto 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: #0a0c14;
        }

        .profile-name {
            font-size: 1.2rem;
            margin-bottom: 5px;
        }

        .profile-role {
            color: #ffb347;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        /* ===== –ê–î–ú–ò–ù –ü–ê–ù–ï–õ–¨ ===== */
        .admin-panel {
            border-color: #dc3545;
        }

        .moderation-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }

        .mod-card {
            background: #1f2a3a;
            border-radius: 15px;
            padding: 15px;
        }

        .mod-actions {
            display: flex;
            gap: 8px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        /* ===== –ó–ê–ì–†–£–ó–ö–ê –§–ê–ô–õ–û–í ===== */
        .upload-area {
            background: #1f2a3a;
            border: 3px dashed #ffb347;
            border-radius: 20px;
            padding: 30px 20px;
            text-align: center;
            cursor: pointer;
            margin-bottom: 15px;
        }

        .upload-area i {
            font-size: 3rem;
            color: #ffb347;
            margin-bottom: 10px;
        }

        .file-info {
            background: #1f2a3a;
            border-radius: 15px;
            padding: 12px;
            margin-bottom: 15px;
            display: none;
            align-items: center;
            gap: 10px;
        }

        .file-info.active {
            display: flex;
        }

        .upload-form input,
        .upload-form textarea,
        .upload-form select {
            width: 100%;
            padding: 10px 15px;
            margin-bottom: 12px;
            background: #1f2a3a;
            border: 2px solid #ffb347;
            border-radius: 50px;
            color: white;
        }

        /* ===== –§–£–¢–ï–† ===== */
        .footer {
            background: #151e2c;
            border-top: 3px solid #ffb347;
            padding: 30px 20px;
            margin-top: 30px;
            display: grid;
            grid-template-columns: 1fr;
            gap: 25px;
        }

        @media (min-width: 768px) {
            .footer {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }
        }

        .footer-section h4 {
            color: #ffb347;
            margin-bottom: 15px;
        }

        .footer-section p {
            margin-bottom: 8px;
            color: #a0a8c0;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .footer-section i {
            width: 20px;
            color: #ffb347;
        }

        /* ===== –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û (–ü–û –¶–ï–ù–¢–†–£) ===== */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(5px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: #151e2c;
            border-radius: 30px;
            padding: 30px;
            max-width: 400px;
            width: 90%;
            border: 3px solid #ffb347;
            animation: slideInUp 0.3s ease;
            position: relative;
            margin: 0 auto;
        }

        .modal-content h2 {
            color: #ffb347;
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.8rem;
        }

        .modal-input {
            width: 100%;
            padding: 12px 20px;
            margin: 10px 0;
            background: #1f2a3a;
            border: 2px solid #ffb347;
            border-radius: 50px;
            color: white;
            font-size: 1rem;
        }

        .modal-input:focus {
            outline: none;
            border-color: #ff7f50;
            box-shadow: 0 0 10px rgba(255, 180, 70, 0.5);
        }

        .modal-select {
            width: 100%;
            padding: 12px 20px;
            margin: 10px 0;
            background: #1f2a3a;
            border: 2px solid #ffb347;
            border-radius: 50px;
            color: white;
            font-size: 1rem;
            cursor: pointer;
        }

        .modal-select option {
            background: #1f2a3a;
        }

        .modal-buttons {
            display: flex;
            gap: 15px;
            margin-top: 25px;
        }

        .modal-buttons .btn {
            flex: 1;
            padding: 12px;
            font-size: 1rem;
        }

        .close-modal {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 2rem;
            color: #ffb347;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            transition: 0.2s;
        }

        .close-modal:hover {
            background: rgba(255, 180, 70, 0.2);
            transform: rotate(90deg);
        }

        /* ===== –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø ===== */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #ffb347;
            color: #0a0c14;
            padding: 12px 25px;
            border-radius: 50px;
            z-index: 2000;
            animation: slideInUp 0.3s;
            font-weight: 600;
            box-shadow: 0 5px 15px rgba(255, 180, 70, 0.3);
        }

        /* ===== –°–¢–†–ê–ù–ò–¶–´ ===== */
        .page {
            display: none;
        }

        .page.active {
            display: block;
        }
    </style>
</head>
<body>
    <!-- –®–∞–ø–∫–∞ -->
    <div class="header">
        <div class="logo" onclick="navigateTo('home')">
            <i class="fas fa-gamepad"></i>
            <h1>PlayVortex</h1>
        </div>
        <div class="nav">
            <a onclick="navigateTo('home')" class="nav-link active" data-page="home">–ì–ª–∞–≤–Ω–∞—è</a>
            <a onclick="navigateTo('catalog')" class="nav-link" data-page="catalog">–ò–≥—Ä—ã</a>
            <a onclick="navigateTo('games')" class="nav-link" data-page="games">–ú–∏–Ω–∏-–∏–≥—Ä—ã</a>
        </div>
        <div class="auth-buttons" id="headerAuth"></div>
    </div>

    <div class="main-content">
        <!-- –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å -->
        <div id="adminPanel" style="display: none;">
            <div class="panel admin-panel">
                <h2 class="panel-title"><i class="fas fa-shield-alt"></i> –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h2>
                <div class="moderation-grid" id="moderationList"></div>
            </div>
        </div>

        <!-- –ü–∞–Ω–µ–ª—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ -->
        <div id="developerPanel" style="display: none;">
            <div class="panel">
                <h2 class="panel-title"><i class="fas fa-upload"></i> –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–≥—Ä—É</h2>
                
                <div class="upload-area" id="fileUploadArea">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <p>–ù–∞–∂–º–∏ –∏–ª–∏ –ø–µ—Ä–µ—Ç–∞—â–∏ —Ñ–∞–π–ª</p>
                    <small>.html, .htm, .zip</small>
                    <input type="file" id="gameFile" style="display: none;" accept=".html,.htm,.zip">
                </div>

                <div class="file-info" id="fileInfo">
                    <i class="fas fa-file"></i>
                    <div id="fileName">–§–∞–π–ª –Ω–µ –≤—ã–±—Ä–∞–Ω</div>
                </div>

                <div class="upload-form">
                    <input type="text" id="gameTitle" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∏–≥—Ä—ã">
                    <textarea id="gameDesc" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ"></textarea>
                    <select id="gameGenre">
                        <option value="action">–≠–∫—à–µ–Ω</option>
                        <option value="rpg">RPG</option>
                        <option value="strategy">–°—Ç—Ä–∞—Ç–µ–≥–∏—è</option>
                    </select>
                    <button class="btn btn-primary" id="uploadBtn" disabled>–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
                </div>
            </div>
        </div>

        <!-- –ì–ª–∞–≤–Ω–∞—è -->
        <div id="homePage" class="page active">
            <div class="home-grid">
                <div class="panel">
                    <h2 class="panel-title"><i class="fas fa-newspaper"></i> –ù–æ–≤–æ—Å—Ç–∏</h2>
                    <div class="news-item" onclick="showNotification('üì∞ –ù–æ–≤–æ—Å—Ç—å 1')">
                        <div class="news-date">14 —Ñ–µ–≤—Ä–∞–ª—è 2026</div>
                        <div class="news-title">üéÆ –§–µ—Å—Ç–∏–≤–∞–ª—å –∏–Ω–¥–∏-–∏–≥—Ä</div>
                        <div class="news-preview">200+ –Ω–æ–≤—ã—Ö –∏–≥—Ä, –¥–µ–º–æ-–≤–µ—Ä—Å–∏–∏</div>
                    </div>
                    <div class="news-item" onclick="showNotification('üì∞ –ù–æ–≤–æ—Å—Ç—å 2')">
                        <div class="news-date">13 —Ñ–µ–≤—Ä–∞–ª—è 2026</div>
                        <div class="news-title">üöÄ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ StarPath</div>
                        <div class="news-preview">–ù–æ–≤–∞—è –∑–≤–µ–∑–¥–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞</div>
                    </div>
                </div>
                <div class="panel">
                    <h2 class="panel-title"><i class="fas fa-gamepad"></i> –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ</h2>
                    <div class="catalog-grid" id="homeGamesGrid"></div>
                </div>
            </div>
        </div>

        <!-- –ö–∞—Ç–∞–ª–æ–≥ -->
        <div id="catalogPage" class="page">
            <div class="panel">
                <h2 class="panel-title"><i class="fas fa-gamepad"></i> –í—Å–µ –∏–≥—Ä—ã</h2>
                <div class="catalog-grid" id="catalogGrid"></div>
            </div>
        </div>

        <!-- –ú–∏–Ω–∏-–∏–≥—Ä—ã -->
        <div id="gamesPage" class="page">
            <div class="panel">
                <h2 class="panel-title"><i class="fas fa-dice"></i> –ú–∏–Ω–∏-–∏–≥—Ä—ã</h2>
                
                <div class="games-container">
                    <div class="game-box">
                        <h3 style="color:#ffb347; text-align:center;">üêç –ó–º–µ–π–∫–∞</h3>
                        <div class="snake-game">
                            <canvas id="snakeCanvas" width="400" height="400"></canvas>
                            <div class="score">–°—á–µ—Ç: <span id="snakeScore">0</span></div>
                            <div class="game-controls">
                                <button class="btn btn-primary" onclick="startSnake()">–ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
                                <button class="btn" onclick="showNotification('–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–µ–ª–∫–∞–º–∏')">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</button>
                            </div>
                        </div>
                    </div>
                    <div class="game-box">
                        <h3 style="color:#ffb347; text-align:center;">üñ±Ô∏è –ö–ª–∏–∫–µ—Ä</h3>
                        <div class="clicker-game">
                            <div class="clicker-count" id="clickerCount">0</div>
                            <div class="clicker-button" onclick="clickGame()"></div>
                            <div class="game-controls">
                                <button class="btn btn-primary" onclick="resetClicker()">–°–±—Ä–æ—Å</button>
                                <button class="btn" onclick="showNotification('–ö–ª–∏–∫–∞–π –ø–æ –∫–Ω–æ–ø–∫–µ')">–ò–Ω—Ñ–æ</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ü—Ä–æ—Ñ–∏–ª—å -->
    <div class="profile-sidebar">
        <div class="profile-card">
            <div class="profile-avatar" id="profileAvatar">
                <i class="fas fa-user"></i>
            </div>
            <div class="profile-name" id="profileName">–ì–æ—Å—Ç—å</div>
            <div class="profile-role" id="profileRole">üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</div>
            <div id="profileAuth"></div>
        </div>
    </div>

    <!-- –§—É—Ç–µ—Ä -->
    <footer class="footer">
        <div class="footer-section">
            <h4>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h4>
            <p onclick="copyText('Dushavolka1@gmail.com')"><i class="fas fa-envelope"></i> Dushavolka1@gmail.com</p>
            <p onclick="copyText('79697673871')"><i class="fas fa-phone"></i> 79697673871</p>
            <p onclick="copyText('@BlumSale_PF')"><i class="fab fa-telegram"></i> @BlumSale_PF</p>
        </div>
        <div class="footer-section">
            <h4>–ü–æ–º–æ—â—å</h4>
            <p onclick="showNotification('‚ùì FAQ')">–ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã</p>
            <p onclick="showNotification('üìß –ü–æ–¥–¥–µ—Ä–∂–∫–∞')">–ù–∞–ø–∏—Å–∞—Ç—å –Ω–∞–º</p>
        </div>
    </footer>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û (–ü–û –¶–ï–ù–¢–†–£) -->
    <div class="modal" id="authModal">
        <span class="close-modal" onclick="closeModal()">&times;</span>
        <div class="modal-content">
            <h2 id="modalTitle">–í—Ö–æ–¥</h2>
            
            <input type="text" class="modal-input" id="modalName" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
            <input type="password" class="modal-input" id="modalPass" placeholder="–ü–∞—Ä–æ–ª—å">
            
            <div id="roleSelect" style="display: none;">
                <select class="modal-select" id="modalRole">
                    <option value="player">–ò–≥—Ä–æ–∫</option>
                    <option value="developer">–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫</option>
                </select>
            </div>
            
            <div class="modal-buttons">
                <button class="btn" onclick="closeModal()">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" id="modalAction" onclick="handleAuth()">–í–æ–π—Ç–∏</button>
            </div>
        </div>
    </div>

    <script>
        // ========== –î–ê–ù–ù–´–ï ==========
        let currentUser = null;
        let modalMode = 'login';
        let selectedFile = null;
        let snakeInterval = null;
        let clickCount = 0;

        let games = JSON.parse(localStorage.getItem('playVortex_games')) || [
            { 
                id: 1, 
                title: 'CyberPulse', 
                genre: 'action', 
                author: 'admin', 
                likes: 128, 
                plays: 2300, 
                status: 'approved',
                fileContent: '<!DOCTYPE html><html><body style="background:#0a0c14;color:#ffb347;display:flex;align-items:center;justify-content:center;height:100vh"><h1>üéÆ CyberPulse</h1></body></html>'
            },
            { 
                id: 2, 
                title: 'Dragon\'s Quest', 
                genre: 'rpg', 
                author: 'dev', 
                likes: 89, 
                plays: 1800, 
                status: 'approved',
                fileContent: '<!DOCTYPE html><html><body style="background:#0a0c14;color:#4a6fa5;display:flex;align-items:center;justify-content:center;height:100vh"><h1>üêâ Dragon\'s Quest</h1></body></html>'
            },
            { 
                id: 3, 
                title: 'Space Rangers', 
                genre: 'strategy', 
                author: 'new_dev', 
                likes: 45, 
                plays: 900, 
                status: 'pending',
                fileContent: '<!DOCTYPE html><html><body style="background:#0a0c14;color:#28a745;display:flex;align-items:center;justify-content:center;height:100vh"><h1>üöÄ Space Rangers</h1></body></html>'
            }
        ];

        // ========== –ó–ú–ï–ô–ö–ê ==========
        let snake = {
            canvas: null,
            ctx: null,
            snake: [{x: 10, y: 10}],
            food: {x: 15, y: 15},
            direction: {x: 0, y: 0},
            score: 0,
            gameOver: false
        };

        function initSnake() {
            snake.canvas = document.getElementById('snakeCanvas');
            if (!snake.canvas) return;
            snake.ctx = snake.canvas.getContext('2d');
            
            document.removeEventListener('keydown', snakeKeyHandler);
            document.addEventListener('keydown', snakeKeyHandler);
            
            startSnake();
        }

        function snakeKeyHandler(e) {
            if (!snake || snake.gameOver) return;
            if (e.key.startsWith('Arrow')) e.preventDefault();
            
            if (e.key === 'ArrowUp' && snake.direction.y === 0) {
                snake.direction = {x: 0, y: -1};
            } else if (e.key === 'ArrowDown' && snake.direction.y === 0) {
                snake.direction = {x: 0, y: 1};
            } else if (e.key === 'ArrowLeft' && snake.direction.x === 0) {
                snake.direction = {x: -1, y: 0};
            } else if (e.key === 'ArrowRight' && snake.direction.x === 0) {
                snake.direction = {x: 1, y: 0};
            }
        }

        function startSnake() {
            if (snakeInterval) clearInterval(snakeInterval);
            
            snake.snake = [{x: 10, y: 10}];
            snake.direction = {x: 0, y: 0};
            snake.score = 0;
            snake.gameOver = false;
            document.getElementById('snakeScore').textContent = '0';
            
            generateFood();
            drawSnake();
            
            snakeInterval = setInterval(() => {
                if (!snake.gameOver) {
                    updateSnake();
                    drawSnake();
                }
            }, 150);
        }

        function generateFood() {
            do {
                snake.food = {
                    x: Math.floor(Math.random() * 20),
                    y: Math.floor(Math.random() * 20)
                };
            } while (snake.snake.some(s => s.x === snake.food.x && s.y === snake.food.y));
        }

        function updateSnake() {
            if (snake.direction.x === 0 && snake.direction.y === 0) return;
            
            const head = {
                x: snake.snake[0].x + snake.direction.x,
                y: snake.snake[0].y + snake.direction.y
            };
            
            if (head.x < 0 || head.x >= 20 || head.y < 0 || head.y >= 20) {
                snake.gameOver = true;
                clearInterval(snakeInterval);
                showNotification('üíÄ –ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –°—á–µ—Ç: ' + snake.score);
                return;
            }
            
            if (snake.snake.some(s => s.x === head.x && s.y === head.y)) {
                snake.gameOver = true;
                clearInterval(snakeInterval);
                showNotification('üíÄ –ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –°—á–µ—Ç: ' + snake.score);
                return;
            }
            
            snake.snake.unshift(head);
            
            if (head.x === snake.food.x && head.y === snake.food.y) {
                snake.score += 10;
                document.getElementById('snakeScore').textContent = snake.score;
                generateFood();
            } else {
                snake.snake.pop();
            }
        }

        function drawSnake() {
            if (!snake.ctx) return;
            
            snake.ctx.fillStyle = '#0a0c14';
            snake.ctx.fillRect(0, 0, 400, 400);
            
            snake.ctx.strokeStyle = '#1f2a3a';
            for (let i = 0; i <= 20; i++) {
                snake.ctx.beginPath();
                snake.ctx.moveTo(i * 20, 0);
                snake.ctx.lineTo(i * 20, 400);
                snake.ctx.stroke();
                
                snake.ctx.beginPath();
                snake.ctx.moveTo(0, i * 20);
                snake.ctx.lineTo(400, i * 20);
                snake.ctx.stroke();
            }
            
            snake.snake.forEach((segment, i) => {
                snake.ctx.fillStyle = i === 0 ? '#ffb347' : '#ff9f4d';
                snake.ctx.fillRect(segment.x * 20 + 2, segment.y * 20 + 2, 16, 16);
            });
            
            snake.ctx.fillStyle = '#ff6b6b';
            snake.ctx.beginPath();
            snake.ctx.arc(snake.food.x * 20 + 10, snake.food.y * 20 + 10, 8, 0, Math.PI * 2);
            snake.ctx.fill();
        }

        // ========== –ö–õ–ò–ö–ï–† ==========
        function clickGame() {
            if (!currentUser) {
                showNotification('üîí –í–æ–π–¥–∏—Ç–µ, —á—Ç–æ–±—ã –∏–≥—Ä–∞—Ç—å');
                openModal('login');
                return;
            }
            clickCount++;
            document.getElementById('clickerCount').textContent = clickCount;
            if (clickCount % 10 === 0) showNotification('üéâ +10 –∫–ª–∏–∫–æ–≤!');
        }

        function resetClicker() {
            clickCount = 0;
            document.getElementById('clickerCount').textContent = '0';
            showNotification('üîÑ –°—á–µ—Ç —Å–±—Ä–æ—à–µ–Ω');
        }

        // ========== –ó–ê–ü–£–°–ö –ò–ì–†–´ ==========
        function playGame(id) {
            const game = games.find(g => g.id === id);
            if (!game) return;

            if (!currentUser) {
                showNotification('üîí –í–æ–π–¥–∏—Ç–µ, —á—Ç–æ–±—ã –∏–≥—Ä–∞—Ç—å');
                openModal('login');
                return;
            }

            if (game.status === 'pending' && currentUser.role !== 'moderator') {
                showNotification('‚è≥ –ò–≥—Ä–∞ –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏');
                return;
            }

            game.plays++;
            localStorage.setItem('playVortex_games', JSON.stringify(games));

            if (game.fileContent) {
                const gameWindow = window.open('', '_blank');
                gameWindow.document.write(game.fileContent);
                gameWindow.document.title = game.title;
            } else {
                showNotification('üéÆ –ó–∞–ø—É—Å–∫: ' + game.title);
            }
        }

        // ========== –ù–ê–í–ò–ì–ê–¶–ò–Ø ==========
        function navigateTo(page) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(page + 'Page').classList.add('active');
            
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
                if (link.dataset.page === page) link.classList.add('active');
            });
            
            if (page === 'games') {
                setTimeout(initSnake, 100);
            }
        }

        // ========== –û–¢–û–ë–†–ê–ñ–ï–ù–ò–ï ==========
        function renderAll() {
            const approved = games.filter(g => g.status === 'approved');
            
            document.getElementById('homeGamesGrid').innerHTML = approved.slice(0, 4).map(game => `
                <div class="game-card" onclick="playGame(${game.id})">
                    <div class="game-icon"><i class="fas fa-${game.genre === 'action' ? 'fist-raised' : 'dragon'}"></i></div>
                    <h4>${game.title}</h4>
                </div>
            `).join('');
            
            document.getElementById('catalogGrid').innerHTML = approved.map(game => `
                <div class="game-card" onclick="playGame(${game.id})">
                    <div class="game-icon"><i class="fas fa-${game.genre === 'action' ? 'fist-raised' : 'dragon'}"></i></div>
                    <h4>${game.title}</h4>
                    <p>${game.author}</p>
                </div>
            `).join('');
            
            document.getElementById('moderationList').innerHTML = games.map(game => `
                <div class="mod-card">
                    <h4>${game.title}</h4>
                    <p>–°—Ç–∞—Ç—É—Å: ${game.status}</p>
                    <div class="mod-actions">
                        ${game.status === 'pending' ? 
                            `<button class="btn btn-success btn-small" onclick="approveGame(${game.id})">‚úÖ</button>
                             <button class="btn btn-danger btn-small" onclick="rejectGame(${game.id})">‚ùå</button>` : 
                            `<button class="btn btn-danger btn-small" onclick="rejectGame(${game.id})">üóëÔ∏è</button>`
                        }
                        <button class="btn btn-primary btn-small" onclick="playGame(${game.id})">üéÆ</button>
                    </div>
                </div>
            `).join('');
        }

        function approveGame(id) {
            const game = games.find(g => g.id === id);
            if (game) {
                game.status = 'approved';
                localStorage.setItem('playVortex_games', JSON.stringify(games));
                renderAll();
                showNotification('‚úÖ –ò–≥—Ä–∞ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–∞');
            }
        }

        function rejectGame(id) {
            games = games.filter(g => g.id !== id);
            localStorage.setItem('playVortex_games', JSON.stringify(games));
            renderAll();
            showNotification('üóëÔ∏è –ò–≥—Ä–∞ —É–¥–∞–ª–µ–Ω–∞');
        }

        // ========== –ó–ê–ì–†–£–ó–ö–ê ==========
        function setupFileUpload() {
            const area = document.getElementById('fileUploadArea');
            const input = document.getElementById('gameFile');
            const info = document.getElementById('fileInfo');
            const fileName = document.getElementById('fileName');
            const uploadBtn = document.getElementById('uploadBtn');

            if (!area) return;

            area.addEventListener('click', () => input.click());
            
            input.addEventListener('change', (e) => {
                if (e.target.files.length) {
                    selectedFile = e.target.files[0];
                    fileName.textContent = selectedFile.name;
                    info.classList.add('active');
                    uploadBtn.disabled = false;
                }
            });

            uploadBtn?.addEventListener('click', () => {
                if (!currentUser || currentUser.role !== 'developer') {
                    showNotification('‚ùå –¢–æ–ª—å–∫–æ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –º–æ–≥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å –∏–≥—Ä—ã');
                    return;
                }

                const title = document.getElementById('gameTitle').value;
                const desc = document.getElementById('gameDesc').value;

                if (!title || !desc || !selectedFile) {
                    showNotification('‚ùå –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                    return;
                }

                const reader = new FileReader();
                reader.onload = (e) => {
                    const newGame = {
                        id: Date.now(),
                        title,
                        desc,
                        genre: document.getElementById('gameGenre').value,
                        fileContent: e.target.result,
                        author: currentUser.name,
                        likes: 0,
                        plays: 0,
                        status: 'pending'
                    };

                    games.push(newGame);
                    localStorage.setItem('playVortex_games', JSON.stringify(games));
                    
                    document.getElementById('gameTitle').value = '';
                    document.getElementById('gameDesc').value = '';
                    document.getElementById('fileInfo').classList.remove('active');
                    selectedFile = null;
                    uploadBtn.disabled = true;
                    
                    showNotification('‚úÖ –ò–≥—Ä–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é');
                    renderAll();
                };
                reader.readAsText(selectedFile);
            });
        }

        // ========== –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø ==========
        function openModal(mode) {
            modalMode = mode;
            const modal = document.getElementById('authModal');
            const title = document.getElementById('modalTitle');
            const actionBtn = document.getElementById('modalAction');
            const roleSelect = document.getElementById('roleSelect');
            
            if (mode === 'login') {
                title.textContent = '–í—Ö–æ–¥';
                actionBtn.textContent = '–í–æ–π—Ç–∏';
                roleSelect.style.display = 'none';
            } else {
                title.textContent = '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è';
                actionBtn.textContent = '–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç';
                roleSelect.style.display = 'block';
            }
            
            modal.classList.add('active');
        }

        function closeModal() {
            document.getElementById('authModal').classList.remove('active');
        }

        function handleAuth() {
            const name = document.getElementById('modalName').value;
            const pass = document.getElementById('modalPass').value;
            const role = document.getElementById('modalRole')?.value || 'player';

            if (!name || !pass) {
                showNotification('‚ùå –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }

            if (name === 'admin' && pass === 'admin') {
                currentUser = { name: '–ê–¥–º–∏–Ω', role: 'moderator' };
            } else if (name === 'dev' && pass === 'dev') {
                currentUser = { name: '–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫', role: 'developer' };
            } else {
                currentUser = { name, role };
            }

            localStorage.setItem('playVortex_user', JSON.stringify(currentUser));
            closeModal();
            updateUI();
            showNotification(`‚úÖ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${currentUser.name}!`);
        }

        function logout() {
            currentUser = null;
            localStorage.removeItem('playVortex_user');
            updateUI();
            showNotification('üëã –î–æ —Å–≤–∏–¥–∞–Ω–∏—è!');
        }

        function updateUI() {
            document.getElementById('headerAuth').innerHTML = currentUser ? 
                `<span style="color:#ffb347;">${currentUser.name}</span>
                 <button class="btn btn-small" onclick="logout()">–í—ã–π—Ç–∏</button>` :
                `<button class="btn btn-small" onclick="openModal('login')">–í–æ–π—Ç–∏</button>
                 <button class="btn btn-primary btn-small" onclick="openModal('register')">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>`;

            document.getElementById('profileAvatar').innerHTML = currentUser ? '<i class="fas fa-user-circle"></i>' : '<i class="fas fa-user"></i>';
            document.getElementById('profileName').textContent = currentUser?.name || '–ì–æ—Å—Ç—å';
            document.getElementById('profileRole').textContent = currentUser?.role === 'moderator' ? 'üõ°Ô∏è –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä' : 
                currentUser?.role === 'developer' ? 'üë®‚Äçüíª –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫' : 'üë§ –ò–≥—Ä–æ–∫';

            document.getElementById('adminPanel').style.display = currentUser?.role === 'moderator' ? 'block' : 'none';
            document.getElementById('developerPanel').style.display = currentUser?.role === 'developer' ? 'block' : 'none';

            document.getElementById('profileAuth').innerHTML = currentUser ?
                `<button class="btn btn-small" style="width:100%;" onclick="logout()">–í—ã–π—Ç–∏</button>` :
                `<button class="btn btn-small" style="width:100%; margin-bottom:5px;" onclick="openModal('login')">–í–æ–π—Ç–∏</button>
                 <button class="btn btn-primary btn-small" style="width:100%;" onclick="openModal('register')">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>`;
        }

        function showNotification(msg) {
            const notif = document.createElement('div');
            notif.className = 'notification';
            notif.textContent = msg;
            document.body.appendChild(notif);
            setTimeout(() => notif.remove(), 2000);
        }

        function copyText(text) {
            navigator.clipboard?.writeText(text);
            showNotification('‚úÖ –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ');
        }

        // ========== –ó–ê–ü–£–°–ö ==========
        updateUI();
        renderAll();
        setupFileUpload();
        setTimeout(initSnake, 100);
    </script>
</body>
</html>
